var e=Object.defineProperty,t=e=>{throw TypeError(e)},a=(t,a,l)=>((t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l)(t,"symbol"!=typeof a?a+"":a,l),l=(e,a,l)=>a.has(e)||t("Cannot "+l),s=(e,t,a)=>(l(e,t,"read from private field"),a?a.call(e):t.get(e)),n=(e,a,l)=>a.has(e)?t("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(e):a.set(e,l),i=(e,t,a)=>(l(e,t,"access private method"),a);(async()=>{var e,t,l,d,r,u,o,c,h,m,p,U,f;const _=["HKHB","HRYR","TAPT","UEEA","UEEE","UELL","UERP","UERR","UESO","UESS","UEST","UHBB","UHBI","UHBW","UHHH","UHKK","UHMA","UHMD","UHMM","UHMP","UHNN","UHOO","UHPP","UHSS","UHWW","UIAA","UIBB","UIBS","UIII","UITT","UIUU","ULAA","ULAM","ULAS","ULBC","ULDD","ULKK","ULLI","ULMK","ULMM","ULNN","ULOL","ULOO","ULPB","ULSS","ULWU","ULWW","UMKK","UNAA","UNBB","UNEE","UNII","UNKL","UNKS","UNKY","UNNT","UNOO","UNSS","UNTT","UNWW","UODD","UOHH","UOII","URKA","URKG","URKK","URMG","URML","URMM","URMN","URMO","URMT","URRR","URRY","URSS","URWA","URWI","URWW","USCC","USCM","USDD","USHU","USII","USKK","USMM","USMU","USNN","USNR","USPP","USRK","USRN","USRO","USRR","USSS","USTJ","USTO","USTR","USUU","UUBA","UUBB","UUBC","UUBI","UUBK","UUBP","UUBS","UUBT","UUDD","UUDL","UUEE","UUEM","UUOB","UUOK","UUOL","UUOO","UUOR","UUOT","UUWR","UUWW","UUYH","UUYI","UUYP","UUYS","UUYW","UUYY","UWGG","UWKB","UWKD","UWKE","UWKJ","UWKS","UWLW","UWOO","UWOR","UWPP","UWPS","UWSB","UWSS","UWUB","UWUF","UWUK","UWUU","UWWW"],v=[-1];for(let a=0;a<800;a+=50)v.push(a);for(let a=800;a<5e3;a+=100)v.push(a);for(let a=5e3;a<1e4;a+=1e3)v.push(a);v.push(9999);e=new WeakMap,t=new WeakMap,l=new WeakSet,d=function(t){const a=Array.from(this.elements).find((e=>e===t.target));if(!a)return;if("click"===t.type&&(a instanceof HTMLInputElement&&s(this,e).includes(a.type)||a instanceof HTMLSelectElement))return;const n=this.registry.get(a);if(!n)return;const{name:d}=n,{format:u,auxiliary:o,update:c}=n.callbacks;if(u&&(a.value=u.call(this,a.value,a)),o&&o.call(this,a.value,a),c){const e=c.call(this,a.value,a);this.result.set(d,e)}i(this,l,r).call(this)},r=function(){const e=[];for(const[a,l]of this.result){const t=l.trim();""!==t&&e.push(t)}const t=e.join(" ");this.output instanceof HTMLInputElement?this.output.value=t:this.output.textContent=t},u=function(e,t){if("string"!=typeof e||""===e)throw new TypeError("AMTK_Form::addHandler must be a non empty string")},o=function(e){this.result.has(e)||this.result.set(e,"")},c=function(e){return Array.from(this.elements).filter((t=>t.name===e))},h=function(e,{format:t,auxiliary:a,update:l}){return{name:e,callbacks:{format:t,auxiliary:a,update:l}}},m=function(e,t){e.forEach((e=>this.registry.set(e,t)))},p=function(e){const t=this.registry.get(e);this.result.set(t.name,e.value)},U=function(e,{checked:t}){if(t){if("string"==typeof t&&(t=[t]),!Array.isArray(t))throw new TypeError("'checked' must be 'string', 'array of strings' or 'null'");for(const a of t){if("string"!=typeof a)throw new TypeError("'checked' must be 'string', 'array of strings' or 'null'");for(const t of e)t instanceof HTMLInputElement&&["checkbox","radio"].includes(t.type)&&t.value===a&&(t.checked=!0,i(this,l,p).call(this,t))}i(this,l,r).call(this)}},f=function(e,{init:t}){t&&(t.call(this,e),i(this,l,r).call(this))};const y=new class{constructor(r){n(this,l),n(this,e,["text","date","time","radio","checkbox"]),n(this,t,["click","input"]),a(this,"root",null),a(this,"output",null),a(this,"elements",null),a(this,"forms",{input:null,output:null}),a(this,"result",new Map),a(this,"registry",new Map),this.root=document.querySelector(r),this.root||console.warn(`can't find a form 'root' with selector ${r}`);const u=Array.from(this.root.children).filter((e=>"FORM"===e.tagName));this.forms.input=null==u?void 0:u.find((e=>e.name.match(/input/i))),this.forms.output=null==u?void 0:u.find((e=>e.name.match(/output/i))),this.forms.input||console.warn(`can't find 'input' form in 'root' element ${r}`),this.forms.output||console.warn(`can't find 'output' form in 'root' element ${r}`),this.elements=this.forms.input.elements,this.output=this.forms.output.elements.output,s(this,t).forEach((e=>this.forms.input.addEventListener(e,(e=>i(this,l,d).call(this,e)))))}updateResult(){i(this,l,r).call(this)}addHandler(e,t={}){i(this,l,u).call(this,e,t),i(this,l,o).call(this,e);const a=i(this,l,c).call(this,t.element??e),s=i(this,l,h).call(this,e,t);i(this,l,m).call(this,a,s),i(this,l,U).call(this,a,t),i(this,l,f).call(this,a,t)}}("#amtk_metar_editor");function g(){let e="";for(const a of this.elements.type)if(a.checked){e+=a.value;break}const{cor:t}=this.elements;return e+=t.checked?` ${t.value}`:"",e}function b(){const{icao:e,icao_variants:t}=this.elements,{value:a}=e;t.innerHTML="";for(const l of _)if(l.startsWith(a)){const e=document.createElement("option");e.value=l,e.textContent=l,t.append(e)}}function H(){const{icao:e}=this.elements,{value:t}=e;return 4===t.length?t:""}function S(e){var t,a,l,s;const{date:n,time:i}=this.elements,d=null==(a=null==(t=n.value)?void 0:t.split("-"))?void 0:a.at(-1),r=null==(s=null==(l=i.value)?void 0:l.split(":"))?void 0:s.join("");return d&&r?`${d}${r}Z`:""}function k(){const{units:e}=this.elements,{direction:t,speed:a,gust:l}=this.elements,{direction_range:s,speed_range:n,gust_range:i}=this.elements,{vrb:d}=this.elements;let r="";if(""===t.value||""===a.value)return r;r+=`${t.value.padStart(3,"0")}${a.value.padStart(2,"0")}`,+l.value>+a.value&&(r+="G"+ +l.value);for(const u of e)if(u.checked){r+=`${u.value}`;break}return r}function E(e,t){const{direction:a,speed:l,gust:s}=this.elements,{direction_range:n,speed_range:i,gust_range:d}=this.elements;switch(t){case n:a.value="-10"===e?"":parseInt(e);break;case i:l.value="-1"===e?"":parseInt(e);break;case d:s.value="-1"===e?"":parseInt(e)}}function x(){const{visibility:e}=this.elements,{value:t}=e;return""===t?"":t.padStart(4,"0")}function N(e){const{weather:t}=this.elements;""!==e&&(t.value+=e)}function W(){const{weather:e}=this.elements,t=e.value.trim();return t.length>1?t:""}function w(e){if(""===(e=e.trim()))return"";const t=e.substr(0,3).replace(/\D/,"");return+t>120?120:t}function M(){let{clouds_1:e,clouds_1_coverage:t,clouds_1_type:a}=this.elements;if(e=e.value.trim(),t=t.value,""===e||"NCD"===t)return"";let l="";l+=t,l+=e.padStart(3,"0");for(const s of a)s.checked&&(l+=s.value);return l}function R(){let{clouds_2:e,clouds_2_coverage:t,clouds_2_type:a}=this.elements;if(e=e.value.trim(),t=t.value,""===e||"NCD"===t)return"";let l="";l+=t,l+=e.padStart(3,"0");for(const s of a)s.checked&&(l+=s.value);return l}function L(){let{clouds_3:e,clouds_3_coverage:t,clouds_3_type:a}=this.elements;if(e=e.value.trim(),t=t.value,""===e||"NCD"===t)return"";let l="";l+=t,l+=e.padStart(3,"0");for(const s of a)s.checked&&(l+=s.value);return l}function D(){let{clouds_4:e,clouds_4_coverage:t,clouds_4_type:a}=this.elements;if(e=e.value.trim(),t=t.value,""===e||"NCD"===t)return"";let l="";l+=t,l+=e.padStart(3,"0");for(const s of a)s.checked&&(l+=s.value);return l}function C(e){if("-"===(e=e.trim()))return e;if(""===e||isNaN(e))return"";const t=+e.match(/-?\d?\d?/);return isNaN(t)&&e.startsWith("-")?"-":isNaN(t)?"":t<-80?-80:t>60?60:t}function T(){const{temperature:e,dew_point:t}=this.elements;if(["","-"].includes(e.value)&&["","-"].includes(t.value))return"";const a=isNaN(+e.value)?"":e.value,l=isNaN(+t.value)?"":t.value;let s="";return s+=""===a?"/":a.replace("-","M"),s+="/",s+=""===l?"/":l.replace("-","M"),s}function I(e,t){const a=e<900||e>1100?"":e;return""===a?"":`Q${a}`}y.addHandler("type",{checked:"METAR",update:g}),y.addHandler("type",{element:"cor",update:g}),y.addHandler("icao",{format:e=>e.trim().toUpperCase().replace(/[^A-Z]/,"").substring(0,4),auxiliary:b,update:H}),y.addHandler("icao",{element:"icao_variants",init:b,auxiliary(e,t){const{icao:a}=this.elements;a.value=e},update:H}),y.addHandler("datetime",{element:"date",update:S}),y.addHandler("datetime",{element:"time",update:S}),y.addHandler("datetime",{element:"current",auxiliary:function(){const{date:e,time:t}=this.elements,a=new Date,l=a.getUTCFullYear(),s=(a.getUTCMonth()+1).toString().padStart(2,"0"),n=a.getUTCDate().toString().padStart(2,"0"),i=a.getUTCHours().toString().padStart(2,"0"),d=a.getUTCMinutes().toString().padStart(2,"0");e.value=`${l}-${s}-${n}`,t.value=`${i}:${d}`},update:S}),y.addHandler("wind",{element:"calm",auxiliary(e,t){const{units:a}=this.elements,{direction:l,speed:s,gust:n}=this.elements,{direction_range:i,speed_range:d,gust_range:r}=this.elements;a.forEach((e=>e.disabled=t.checked)),l.disabled=t.checked,s.disabled=t.checked,n.disabled=t.checked,i.disabled=t.checked,d.disabled=t.checked,r.disabled=t.checked,t.checked&&(a.forEach((e=>e.checked="MPS"===e.value)),l.value="",s.value="",n.value="",i.value=-10,d.value=-1,r.value=-1)},update:(e,t)=>t.checked?"CALM":""}),y.addHandler("wind",{element:"units",init(e){for(const t of e)t.checked="MPS"===t.value},update:k}),y.addHandler("wind",{element:"direction",format(e){const t=parseInt(e.trim().replace(/\D/,"").substring(0,3));return isNaN(t)?"":t>360?360:t},auxiliary(e){const{direction_range:t}=this.elements;t.value=""===e?-20:e},update:k}),y.addHandler("wind",{element:"speed",format:e=>parseInt(e.trim().replace(/\D/,"").substring(0,2)),auxiliary(e){const{speed_range:t}=this.elements;t.value=e},update:k}),y.addHandler("wind",{element:"gust",format:e=>parseInt(e.trim().replace(/\D/,"").substring(0,2)),auxiliary(e){const{gust_range:t}=this.elements;t.value=e},update:k}),y.addHandler("wind",{element:"direction_range",auxiliary:E,update:k}),y.addHandler("wind",{element:"speed_range",auxiliary:E,update:k}),y.addHandler("wind",{element:"gust_range",auxiliary:E,update:k}),y.addHandler("cavok",{element:"cavok",auxiliary(e,t){const{result:a}=this,{visibility:l,visibility_range:s}=this.elements,{weather:n,intensity:i,precipitation:d,phenomena:r}=this.elements,{clouds_1_coverage:u,clouds_1:o,clouds_1_type:c,clouds_1_height:h}=this.elements,{clouds_2_coverage:m,clouds_2:p,clouds_2_type:U,clouds_2_height:f}=this.elements,{clouds_3_coverage:_,clouds_3:v,clouds_3_type:y,clouds_3_height:g}=this.elements,{clouds_4_coverage:b,clouds_4:H,clouds_4_type:S,clouds_4_height:k}=this.elements;t.checked?(l.value="",s.value=-1,n.value="",i.forEach((e=>e.checked=!1)),d.value="",r.value="",u.value="NCD",o.value="",c.forEach((e=>e.checked=!1)),h.value=-1,m.value="NCD",p.value="",U.forEach((e=>e.checked=!1)),f.value=-1,_.value="NCD",v.value="",y.forEach((e=>e.checked=!1)),g.value=-1,b.value="NCD",H.value="",S.forEach((e=>e.checked=!1)),k.value=-1,l.disabled=!0,s.disabled=!0,n.disabled=!0,i.forEach((e=>e.disabled=!0)),d.disabled=!0,r.disabled=!0,u.disabled=!0,o.disabled=!0,c.forEach((e=>e.disabled=!0)),h.disabled=!0,m.disabled=!0,p.disabled=!0,U.forEach((e=>e.disabled=!0)),f.disabled=!0,_.disabled=!0,v.disabled=!0,y.forEach((e=>e.disabled=!0)),g.disabled=!0,b.disabled=!0,H.disabled=!0,S.forEach((e=>e.disabled=!0)),k.disabled=!0,a.visibility=""):(l.disabled=!1,s.disabled=!1,n.disabled=!1,i.forEach((e=>e.disabled=!1)),d.disabled=!1,r.disabled=!1,u.disabled=!1,o.disabled=!1,c.forEach((e=>e.disabled=!1)),h.disabled=!1,m.disabled=!1,p.disabled=!1,U.forEach((e=>e.disabled=!1)),f.disabled=!1,_.disabled=!1,v.disabled=!1,y.forEach((e=>e.disabled=!1)),g.disabled=!1,b.disabled=!1,H.disabled=!1,S.forEach((e=>e.disabled=!1)),k.disabled=!1),this.updateResult()},update:(e,t)=>t.checked?t.value:""}),y.addHandler("visibility",{format:e=>e.trim().replace(/\D/,"").substring(0,4),auxiliary(e){const{visibility_range:t}=this.elements;""===e&&(t.value=-1);const a=+e,l=a<800?50:a<5e3?100:a<9999?1e3:0;let s=v.at(-1);if(l>0){const e=Math.floor(a/l)*l;s=v.indexOf(e)}t.value=s.toString()},update:x}),y.addHandler("visibility",{element:"visibility_range",init(e){const t=e[0];t.setAttribute("min",0),t.setAttribute("max",v.length-1),t.value=v[0]},auxiliary(e){e=+e;const{visibility:t}=this.elements;t.value=0===e?"":v[e]},update:x}),y.addHandler("weather",{element:"weather",format:e=>e.toUpperCase().replace(/[^-+A-Z ]/,""),auxiliary(e){const{intensity:t}=this.elements,a=e[0];for(const l of t)l.checked=l.value===a},update:W}),y.addHandler("weather",{element:"intensity",auxiliary(e,t){let a="";const{intensity:l,weather:s}=this.elements;for(const n of l)n!==t&&(n.checked=!1),n.checked&&(a=n.value);s.value=s.value.replace(/^[+-]/,""),a&&(s.value=a+s.value)},update:W}),y.addHandler("weather",{element:"precipitation",auxiliary:N,update:W}),y.addHandler("weather",{element:"phenomena",auxiliary:N,update:W}),y.addHandler("clouds_1",{element:"clouds_1",format:w,auxiliary:function(e){const{clouds_1_height:t}=this.elements;t.value=""===e?-1:+e},update:M}),y.addHandler("clouds_1",{element:"clouds_1_height",auxiliary:function(e){const{clouds_1:t}=this.elements;t.value=-1===+e?"":e},update:M}),y.addHandler("clouds_1",{element:"clouds_1_coverage",auxiliary:function(e){const{clouds_1:t,clouds_1_height:a,clouds_1_type:l}=this.elements;"NCD"===e&&(t.value="",a.value=-1,l.forEach((e=>e.checked=!1)))},update:M}),y.addHandler("clouds_1",{element:"clouds_1_type",auxiliary:function(e,t){const{clouds_1_type:a}=this.elements;for(const l of a)l!==t&&(l.checked=!1)},update:M}),y.addHandler("clouds_2",{element:"clouds_2",format:w,auxiliary:function(e){const{clouds_2_height:t}=this.elements;t.value=""===e?-1:+e},update:R}),y.addHandler("clouds_2",{element:"clouds_2_height",auxiliary:function(e){const{clouds_2:t}=this.elements;t.value=-1===+e?"":e},update:R}),y.addHandler("clouds_2",{element:"clouds_2_coverage",auxiliary:function(e){const{clouds_2:t,clouds_2_height:a,clouds_2_type:l}=this.elements;"NCD"===e&&(t.value="",a.value=-1,l.forEach((e=>e.checked=!1)))},update:R}),y.addHandler("clouds_2",{element:"clouds_2_type",auxiliary:function(e,t){const{clouds_2_type:a}=this.elements;for(const l of a)l!==t&&(l.checked=!1)},update:R}),y.addHandler("clouds_3",{element:"clouds_3",format:w,auxiliary:function(e){const{clouds_3_height:t}=this.elements;t.value=""===e?-1:+e},update:L}),y.addHandler("clouds_3",{element:"clouds_3_height",auxiliary:function(e){const{clouds_3:t}=this.elements;t.value=-1===+e?"":e},update:L}),y.addHandler("clouds_3",{element:"clouds_3_coverage",auxiliary:function(e){const{clouds_3:t,clouds_3_height:a,clouds_3_type:l}=this.elements;"NCD"===e&&(t.value="",a.value=-1,l.forEach((e=>e.checked=!1)))},update:L}),y.addHandler("clouds_3",{element:"clouds_3_type",auxiliary:function(e,t){const{clouds_3_type:a}=this.elements;for(const l of a)l!==t&&(l.checked=!1)},update:L}),y.addHandler("clouds_4",{element:"clouds_4",format:w,auxiliary:function(e){const{clouds_4_height:t}=this.elements;t.value=""===e?-1:+e},update:D}),y.addHandler("clouds_4",{element:"clouds_4_height",auxiliary:function(e){const{clouds_4:t}=this.elements;t.value=-1===+e?"":e},update:D}),y.addHandler("clouds_4",{element:"clouds_4_coverage",auxiliary:function(e){const{clouds_4:t,clouds_4_height:a,clouds_4_type:l}=this.elements;"NCD"===e&&(t.value="",a.value=-1,l.forEach((e=>e.checked=!1)))},update:D}),y.addHandler("clouds_4",{element:"clouds_4_type",auxiliary:function(e,t){const{clouds_4_type:a}=this.elements;for(const l of a)l!==t&&(l.checked=!1)},update:D}),y.addHandler("temperature",{element:"temperature",format:C,auxiliary(e){const{temperature_range:t}=this.elements;t.value=["","-"].includes(e)?-81:e},update:T}),y.addHandler("temperature",{element:"dew_point",format:C,auxiliary(e){const{dew_point_range:t}=this.elements;t.value=["","-"].includes(e)?-81:e},update:T}),y.addHandler("temperature",{element:"temperature_range",auxiliary(e){e=+e;const{temperature:t}=this.elements;t.value=-81===e?"":e},update:T}),y.addHandler("temperature",{element:"dew_point_range",auxiliary(e){e=+e;const{dew_point:t}=this.elements;t.value=-81===e?"":e},update:T}),y.addHandler("pressure",{format:e=>""===(e=e.trim().replace(/\D/,"").substring(0,4))?"":+e>1100?1100:e,auxiliary(e){const{pressure_range:t}=this.elements;t.value=""===e||+e<500?499:e},update:I}),y.addHandler("pressure",{element:"pressure_range",auxiliary(e){const{pressure:t}=this.elements;t.value=499===+e?"":e},update:I}),y.addHandler("trend",{element:"trend_text",format:e=>e.trim().toUpperCase(),update:e=>e})})();
