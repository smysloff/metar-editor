!function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function t(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function n(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r(e,n){return e.get(t(e,n))}function a(e,t,r){n(e,t),t.set(e,r)}function i(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){o=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw i}}}}function o(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,l,o=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t);else for(;!(u=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);u=!0);}catch(e){c=!0,a=e}finally{try{if(!u&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw a}}return o}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function s(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}var d=new WeakMap,f=new WeakMap,U=new WeakSet,h=function(){return i((function e(i){var l,u,c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(l=this,u=U),u.add(l),a(this,d,["text","date","time","radio","checkbox"]),a(this,f,["click","input"]),o(this,"root",null),o(this,"output",null),o(this,"elements",null),o(this,"forms",{input:null,output:null}),o(this,"result",new Map),o(this,"registry",new Map),this.root=document.querySelector(i),this.root||console.warn("can't find a form 'root' with selector ".concat(i));var s=Array.from(this.root.children).filter((function(e){return"FORM"===e.tagName}));this.forms.input=null==s?void 0:s.find((function(e){return e.name.match(/input/i)})),this.forms.output=null==s?void 0:s.find((function(e){return e.name.match(/output/i)})),this.forms.input||console.warn("can't find 'input' form in 'root' element ".concat(i)),this.forms.output||console.warn("can't find 'output' form in 'root' element ".concat(i)),this.elements=this.forms.input.elements,this.output=this.forms.output.elements.output,r(f,this).forEach((function(e){return c.forms.input.addEventListener(e,(function(e){return t(U,c,v).call(c,e)}))}))}),[{key:"updateResult",value:function(){t(U,this,m).call(this)}},{key:"addHandler",value:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(U,this,p).call(this,e,r),t(U,this,y).call(this,e);var a=t(U,this,g).call(this,null!==(n=r.element)&&void 0!==n?n:e),i=t(U,this,S).call(this,e,r);t(U,this,b).call(this,a,i),t(U,this,H).call(this,a,r),t(U,this,W).call(this,a,r)}}])}();function v(e){var n=Array.from(this.elements).find((function(t){return t===e.target}));if(n&&("click"!==e.type||!(n instanceof HTMLInputElement&&r(d,this).includes(n.type)||n instanceof HTMLSelectElement))){var a=this.registry.get(n);if(a){var i=a.name,l=a.callbacks,o=l.format,u=l.auxiliary,c=l.update;if(o&&(n.value=o.call(this,n.value,n)),u&&u.call(this,n.value,n),c){var s=c.call(this,n.value,n);this.result.set(i,s)}t(U,this,m).call(this)}}}function m(){var e,t=[],n=l(this.result);try{for(n.s();!(e=n.n()).done;){var r=u(e.value,2),a=(r[0],r[1].trim());""!==a&&t.push(a)}}catch(e){n.e(e)}finally{n.f()}var i=t.join(" ");this.output instanceof HTMLInputElement?this.output.value=i:this.output.textContent=i}function p(e,t){if("string"!=typeof e||""===e)throw new TypeError("AMTK_Form::addHandler must be a non empty string")}function y(e){this.result.has(e)||this.result.set(e,"")}function g(e){return Array.from(this.elements).filter((function(t){return t.name===e}))}function S(e,t){return{name:e,callbacks:{format:t.format,auxiliary:t.auxiliary,update:t.update}}}function b(e,t){var n=this;e.forEach((function(e){return n.registry.set(e,t)}))}function w(e){var t=this.registry.get(e);this.result.set(t.name,e.value)}function H(e,n){var r=n.checked;if(r){if("string"==typeof r&&(r=[r]),!Array.isArray(r))throw new TypeError("'checked' must be 'string', 'array of strings' or 'null'");var a,i=l(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;if("string"!=typeof o)throw new TypeError("'checked' must be 'string', 'array of strings' or 'null'");var u,c=l(e);try{for(c.s();!(u=c.n()).done;){var s=u.value;s instanceof HTMLInputElement&&["checkbox","radio"].includes(s.type)&&s.value===o&&(s.checked=!0,t(U,this,w).call(this,s))}}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}t(U,this,m).call(this)}}function W(e,n){var r=n.init;r&&(r.call(this,e),t(U,this,m).call(this))}function M(){var e,t="",n=l(this.elements.type);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.checked){t+=r.value;break}}}catch(e){n.e(e)}finally{n.f()}var a=this.elements.cor;return t+=a.checked?" ".concat(a.value):""}var E=["HKHB","HRYR","TAPT","UEEA","UEEE","UELL","UERP","UERR","UESO","UESS","UEST","UHBB","UHBI","UHBW","UHHH","UHKK","UHMA","UHMD","UHMM","UHMP","UHNN","UHOO","UHPP","UHSS","UHWW","UIAA","UIBB","UIBS","UIII","UITT","UIUU","ULAA","ULAM","ULAS","ULBC","ULDD","ULKK","ULLI","ULMK","ULMM","ULNN","ULOL","ULOO","ULPB","ULSS","ULWU","ULWW","UMKK","UNAA","UNBB","UNEE","UNII","UNKL","UNKS","UNKY","UNNT","UNOO","UNSS","UNTT","UNWW","UODD","UOHH","UOII","URKA","URKG","URKK","URMG","URML","URMM","URMN","URMO","URMT","URRR","URRY","URSS","URWA","URWI","URWW","USCC","USCM","USDD","USHU","USII","USKK","USMM","USMU","USNN","USNR","USPP","USRK","USRN","USRO","USRR","USSS","USTJ","USTO","USTR","USUU","UUBA","UUBB","UUBC","UUBI","UUBK","UUBP","UUBS","UUBT","UUDD","UUDL","UUEE","UUEM","UUOB","UUOK","UUOL","UUOO","UUOR","UUOT","UUWR","UUWW","UUYH","UUYI","UUYP","UUYS","UUYW","UUYY","UWGG","UWKB","UWKD","UWKE","UWKJ","UWKS","UWLW","UWOO","UWOR","UWPP","UWPS","UWSB","UWSS","UWUB","UWUF","UWUK","UWUU","UWWW"];function k(){this.elements.icao.value=""}function R(){var e=this.elements.icao_variants,t=document.createElement("option");t.textContent="Не найдено",t.disabled=!0,t.selected=!0,e.options.length=0,e.add(t)}function T(){k.call(this),R.call(this)}function I(){var e=this.elements.icao,t=this.elements.icao_variants,n=e.value;if(0!==n.length){R.call(this);var r,a=l(E);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i.startsWith(n)){var o=document.createElement("option");o.value=i,o.textContent=i,t.add(o)}}}catch(e){a.e(e)}finally{a.f()}}else T.call(this)}function A(){var e=this.elements.icao.value;return 4===e.length?e:""}function L(){var e,t,n=this.elements,r=n.date,a=n.time,i=null===(e=r.value)||void 0===e||null===(e=e.split("-"))||void 0===e?void 0:e.at(-1),l=null===(t=a.value)||void 0===t||null===(t=t.split(":"))||void 0===t?void 0:t.join("");return i&&l?"".concat(i).concat(l,"Z"):""}function O(){var e=this.elements,t=e.date,n=e.time,r=new Date,a=r.getUTCFullYear(),i=(r.getUTCMonth()+1).toString().padStart(2,"0"),l=r.getUTCDate().toString().padStart(2,"0"),o=r.getUTCHours().toString().padStart(2,"0"),u=r.getUTCMinutes().toString().padStart(2,"0");t.value="".concat(a,"-").concat(i,"-").concat(l),n.value="".concat(o,":").concat(u)}function K(){var e=this.elements,t=e.direction,n=e.speed,r=e.gust,a=this.elements;a.direction_range,a.speed_range,a.gust_range;var i=this.elements,o=i.units;i.vrb;var u="";if(""===t.value||""===n.value)return u;u+="".concat(t.value.padStart(3,"0")).concat(n.value.padStart(2,"0")),Number(r.value)>Number(n.value)&&(u+="G".concat(r.value));var c,s=l(o);try{for(s.s();!(c=s.n()).done;){var d=c.value;if(d.checked){u+="".concat(d.value);break}}}catch(e){s.e(e)}finally{s.f()}return u}function N(e,t){var n=this.elements,r=n.direction,a=n.speed,i=n.gust,l=this.elements,o=l.direction_range,u=l.speed_range,c=l.gust_range;switch(t){case o:r.value="-10"===e?"":parseInt(e);break;case u:a.value="-1"===e?"":parseInt(e);break;case c:i.value="-1"===e?"":parseInt(e)}}var B={type:function(e){e.addHandler("type",{checked:"METAR",update:M}),e.addHandler("type",{element:"cor",update:M})},icao:function(e){e.addHandler("icao",{format:function(e){return e.trim().toUpperCase().replace(/[^A-Z]/,"").substring(0,4)},auxiliary:I,update:A}),e.addHandler("icao",{element:"icao_variants",init:I,auxiliary:function(e){this.elements.icao.value=e},update:A})},datetime:function(e){e.addHandler("datetime",{element:"date",update:L}),e.addHandler("datetime",{element:"time",update:L}),e.addHandler("datetime",{element:"current",auxiliary:O,update:L})},wind:function(e){e.addHandler("wind",{element:"calm",auxiliary:function(e,t){var n=this.elements.units,r=this.elements,a=r.direction,i=r.speed,l=r.gust,o=this.elements,u=o.direction_range,c=o.speed_range,s=o.gust_range;n.forEach((function(e){return e.disabled=t.checked})),a.disabled=t.checked,i.disabled=t.checked,l.disabled=t.checked,u.disabled=t.checked,c.disabled=t.checked,s.disabled=t.checked,t.checked&&(n.forEach((function(e){return e.checked="MPS"===e.value})),a.value="",i.value="",l.value="",u.value=-10,c.value=-1,s.value=-1)},update:function(e,t){return t.checked?"CALM":""}}),e.addHandler("wind",{element:"units",init:function(e){var t,n=l(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.checked="MPS"===r.value}}catch(e){n.e(e)}finally{n.f()}},update:K}),e.addHandler("wind",{element:"direction",format:function(e){var t=parseInt(e.trim().replace(/\D/,"").substring(0,3));return isNaN(t)?"":t>360?360:t},auxiliary:function(e){this.elements.direction_range.value=""===e?-20:e},update:K}),e.addHandler("wind",{element:"speed",format:function(e){return parseInt(e.trim().replace(/\D/,"").substring(0,2))},auxiliary:function(e){this.elements.speed_range.value=e},update:K}),e.addHandler("wind",{element:"gust",format:function(e){return parseInt(e.trim().replace(/\D/,"").substring(0,2))},auxiliary:function(e){this.elements.gust_range.value=e},update:K}),e.addHandler("wind",{element:"direction_range",auxiliary:N,update:K}),e.addHandler("wind",{element:"speed_range",auxiliary:N,update:K}),e.addHandler("wind",{element:"gust_range",auxiliary:N,update:K})}},x=new h("#amtk_metar_editor");B.type(x),B.icao(x),B.datetime(x),B.wind(x)}();