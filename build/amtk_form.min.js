!function(){"use strict";const e=["HKHB","HRYR","TAPT","UEEA","UEEE","UELL","UERP","UERR","UESO","UESS","UEST","UHBB","UHBI","UHBW","UHHH","UHKK","UHMA","UHMD","UHMM","UHMP","UHNN","UHOO","UHPP","UHSS","UHWW","UIAA","UIBB","UIBS","UIII","UITT","UIUU","ULAA","ULAM","ULAS","ULBC","ULDD","ULKK","ULLI","ULMK","ULMM","ULNN","ULOL","ULOO","ULPB","ULSS","ULWU","ULWW","UMKK","UNAA","UNBB","UNEE","UNII","UNKL","UNKS","UNKY","UNNT","UNOO","UNSS","UNTT","UNWW","UODD","UOHH","UOII","URKA","URKG","URKK","URMG","URML","URMM","URMN","URMO","URMT","URRR","URRY","URSS","URWA","URWI","URWW","USCC","USCM","USDD","USHU","USII","USKK","USMM","USMU","USNN","USNR","USPP","USRK","USRN","USRO","USRR","USSS","USTJ","USTO","USTR","USUU","UUBA","UUBB","UUBC","UUBI","UUBK","UUBP","UUBS","UUBT","UUDD","UUDL","UUEE","UUEM","UUOB","UUOK","UUOL","UUOO","UUOR","UUOT","UUWR","UUWW","UUYH","UUYI","UUYP","UUYS","UUYW","UUYY","UWGG","UWKB","UWKD","UWKE","UWKJ","UWKS","UWLW","UWOO","UWOR","UWPP","UWPS","UWSB","UWSS","UWUB","UWUF","UWUK","UWUU","UWWW"];(async()=>{const t=[-1];for(let e=0;e<800;e+=50)t.push(e);for(let e=800;e<5e3;e+=100)t.push(e);for(let e=5e3;e<1e4;e+=1e3)t.push(e);t.push(9999);const a=new class{#e=["text","date","time","radio","checkbox"];#t=["click","input"];root=null;output=null;elements=null;forms={input:null,output:null};result=new Map;registry=new Map;constructor(e){this.root=document.querySelector(e),this.root||console.warn(`can't find a form 'root' with selector ${e}`);const t=Array.from(this.root.children).filter((e=>"FORM"===e.tagName));this.forms.input=t?.find((e=>e.name.match(/input/i))),this.forms.output=t?.find((e=>e.name.match(/output/i))),this.forms.input||console.warn(`can't find 'input' form in 'root' element ${e}`),this.forms.output||console.warn(`can't find 'output' form in 'root' element ${e}`),this.elements=this.forms.input.elements,this.output=this.forms.output.elements.output,this.#t.forEach((e=>this.forms.input.addEventListener(e,(e=>this.#a(e)))))}#a(e){const t=Array.from(this.elements).find((t=>t===e.target));if(!t)return;if("click"===e.type&&(t instanceof HTMLInputElement&&this.#e.includes(t.type)||t instanceof HTMLSelectElement))return;const a=this.registry.get(t);if(!a)return;const{name:n}=a,{format:s,auxiliary:l,update:i}=a.callbacks;if(s&&(t.value=s.call(this,t.value,t)),l&&l.call(this,t.value,t),i){const e=i.call(this,t.value,t);this.result.set(n,e)}this.#n()}#n(){const e=[];for(const[t,a]of this.result){const t=a.trim();""!==t&&e.push(t)}const t=e.join(" ");this.output instanceof HTMLInputElement?this.output.value=t:this.output.textContent=t}#s(e,t){if("string"!=typeof e||""===e)throw new TypeError("AMTK_Form::addHandler must be a non empty string")}#l(e){this.result.has(e)||this.result.set(e,"")}#i(e){return Array.from(this.elements).filter((t=>t.name===e))}#d(e,{format:t,auxiliary:a,update:n}){return{name:e,callbacks:{format:t,auxiliary:a,update:n}}}#r(e,t){e.forEach((e=>this.registry.set(e,t)))}#u(e){const t=this.registry.get(e);this.result.set(t.name,e.value)}#o(e,{checked:t}){if(t){if("string"==typeof t&&(t=[t]),!Array.isArray(t))throw new TypeError("'checked' must be 'string', 'array of strings' or 'null'");for(const a of t){if("string"!=typeof a)throw new TypeError("'checked' must be 'string', 'array of strings' or 'null'");for(const t of e)t instanceof HTMLInputElement&&["checkbox","radio"].includes(t.type)&&t.value===a&&(t.checked=!0,this.#u(t))}this.#n()}}#c(e,{init:t}){t&&(t.call(this,e),this.#n())}updateResult(){this.#n()}addHandler(e,t={}){this.#s(e,t),this.#l(e);const a=this.#i(t.element??e),n=this.#d(e,t);this.#r(a,n),this.#o(a,t),this.#c(a,t)}}("#amtk_metar_editor");function n(){let e="";for(const t of this.elements.type)if(t.checked){e+=t.value;break}const{cor:t}=this.elements;return e+=t.checked?` ${t.value}`:"",e}function s(){const{icao:t,icao_variants:a}=this.elements,{value:n}=t;a.innerHTML="";for(const t of e)if(t.startsWith(n)){const e=document.createElement("option");e.value=t,e.textContent=t,a.append(e)}}function l(){const{icao:e}=this.elements,{value:t}=e;return 4===t.length?t:""}function i(e){const{date:t,time:a}=this.elements,n=t.value?.split("-")?.at(-1),s=a.value?.split(":")?.join("");return n&&s?`${n}${s}Z`:""}function d(){const{units:e}=this.elements,{direction:t,speed:a,gust:n}=this.elements,{direction_range:s,speed_range:l,gust_range:i}=this.elements,{vrb:d}=this.elements;let r="";if(""===t.value||""===a.value)return r;r+=`${t.value.padStart(3,"0")}${a.value.padStart(2,"0")}`,+n.value>+a.value&&(r+="G"+ +n.value);for(const t of e)if(t.checked){r+=`${t.value}`;break}return r}function r(e,t){const{direction:a,speed:n,gust:s}=this.elements,{direction_range:l,speed_range:i,gust_range:d}=this.elements;switch(t){case l:a.value="-10"===e?"":parseInt(e);break;case i:n.value="-1"===e?"":parseInt(e);break;case d:s.value="-1"===e?"":parseInt(e)}}function u(){const{visibility:e}=this.elements,{value:t}=e;return""===t?"":t.padStart(4,"0")}function o(e){const{weather:t}=this.elements;""!==e&&(t.value+=e)}function c(){const{weather:e}=this.elements,t=e.value.trim();return t.length>1?t:""}function h(e){if(""===(e=e.trim()))return"";const t=e.substr(0,3).replace(/\D/,"");return+t>120?120:t}function m(e,t){let a,n,s;const{clouds_1:l,clouds_1_coverage:i,clouds_1_height:d,clouds_1_type:r}=this.elements,{clouds_2:u,clouds_2_coverage:o,clouds_2_height:c,clouds_2_type:h}=this.elements,{clouds_3:m,clouds_3_coverage:p,clouds_3_height:_,clouds_3_type:U}=this.elements,{clouds_4:f,clouds_4_coverage:v,clouds_4_height:y,clouds_4_type:g}=this.elements;if(l===t||i===t||d===t||Array.from(r).includes(t))a=l.value.trim(),n=i.value,s=r;else if(u===t||o===t||c===t||Array.from(h).includes(t))a=u.value.trim(),n=o.value,s=h;else if(m===t||p===t||_===t||Array.from(U).includes(t))a=m.value.trim(),n=p.value,s=U;else{if(f!==t&&v!==t&&y!==t&&!Array.from(g).includes(t))throw new TypeError("Unable to find the required cloud layer");a=f.value.trim(),n=v.value,s=g}if(""===a)return"";let b="";b+=n,b+=a.padStart(3,"0");for(const e of s)e.checked&&(b+=e.value);return b}function p(e){if("-"===(e=e.trim()))return e;if(""===e||isNaN(e))return"";const t=+e.match(/-?\d?\d?/);return isNaN(t)&&e.startsWith("-")?"-":isNaN(t)?"":t<-80?-80:t>80?80:t}function _(){const{temperature:e,dew_point:t}=this.elements;if(["","-"].includes(e.value)&&["","-"].includes(t.value))return"";const a=isNaN(+e.value)?"":e.value,n=isNaN(+t.value)?"":t.value;let s="";return s+=""===a?"/":a.replace("-","M"),s+="/",s+=""===n?"/":n.replace("-","M"),s}function U(e,t){const{temperature:a,dew_point:n}=this.elements,{temperature_range:s,dew_point_range:l}=this.elements,{temperature_minus:i,dew_point_minus:d}=this.elements;let r=null,u=null;switch(t){case a:r=s,u=i;break;case n:r=l,u=d;break;default:throw new TypeError("unknown element")}if(!(r instanceof HTMLInputElement))throw new TypeError("not an input element");if(!(u instanceof HTMLInputElement))throw new TypeError("minusElement is not a proper HTMLInputElement");r.value=""===e||"-"===e?-1:Math.abs(e),u.checked=e.startsWith("-")}function f(e,t){const{temperature:a,dew_point:n}=this.elements,{temperature_range:s,dew_point_range:l}=this.elements,{temperature_minus:i,dew_point_minus:d}=this.elements;let r="",u="";switch(t){case s:r=a,u=i;break;case l:r=n,u=d;break;default:throw new Error("unknown element")}if(!(r instanceof HTMLInputElement&&"value"in r))throw new TypeError("linkedElement must be a typeof HTMLInputElement(text), but got "+typeof r);if(!(u instanceof HTMLInputElement)||"checkbox"!==u?.type)throw new TypeError("minusElement must be a typeof HTMLInputElement(checkbox), but got "+typeof u);r.value=e<0?"":u.checked?`-${e}`:e}function v(e,t){const{temperature:a,dew_point:n}=this.elements;let s="",l="";switch(t.checked&&(l+="-"),t.name){case"temperature_minus":s=a;break;case"dew_point_minus":s=n;break;default:throw TypeError("unknown element name")}l+=s.value.replace(/\D/,""),isNaN(l)||(s.value=l)}function y(e,t){const a=e<900||e>1100?"":e;return""===a?"":`Q${a}`}a.addHandler("type",{checked:"METAR",update:n}),a.addHandler("type",{element:"cor",update:n}),a.addHandler("icao",{format:e=>e.trim().toUpperCase().replace(/[^A-Z]/,"").substring(0,4),auxiliary:s,update:l}),a.addHandler("icao",{element:"icao_variants",init:s,auxiliary(e,t){const{icao:a}=this.elements;a.value=e},update:l}),a.addHandler("datetime",{element:"date",update:i}),a.addHandler("datetime",{element:"time",update:i}),a.addHandler("datetime",{element:"current",auxiliary:function(){const{date:e,time:t}=this.elements,a=new Date,n=a.getUTCFullYear(),s=(a.getUTCMonth()+1).toString().padStart(2,"0"),l=a.getUTCDate().toString().padStart(2,"0"),i=a.getUTCHours().toString().padStart(2,"0"),d=a.getUTCMinutes().toString().padStart(2,"0");e.value=`${n}-${s}-${l}`,t.value=`${i}:${d}`},update:i}),a.addHandler("wind",{element:"calm",auxiliary(e,t){const{units:a}=this.elements,{direction:n,speed:s,gust:l}=this.elements,{direction_range:i,speed_range:d,gust_range:r}=this.elements;a.forEach((e=>e.disabled=t.checked)),n.disabled=t.checked,s.disabled=t.checked,l.disabled=t.checked,i.disabled=t.checked,d.disabled=t.checked,r.disabled=t.checked,t.checked&&(a.forEach((e=>e.checked="MPS"===e.value)),n.value="",s.value="",l.value="",i.value=-10,d.value=-1,r.value=-1)},update:(e,t)=>t.checked?"CALM":""}),a.addHandler("wind",{element:"units",init(e){for(const t of e)t.checked="MPS"===t.value},update:d}),a.addHandler("wind",{element:"direction",format(e){const t=parseInt(e.trim().replace(/\D/,"").substring(0,3));return isNaN(t)?"":t>360?360:t},auxiliary(e){const{direction_range:t}=this.elements;t.value=""===e?-20:e},update:d}),a.addHandler("wind",{element:"speed",format:e=>parseInt(e.trim().replace(/\D/,"").substring(0,2)),auxiliary(e){const{speed_range:t}=this.elements;t.value=e},update:d}),a.addHandler("wind",{element:"gust",format:e=>parseInt(e.trim().replace(/\D/,"").substring(0,2)),auxiliary(e){const{gust_range:t}=this.elements;t.value=e},update:d}),a.addHandler("wind",{element:"direction_range",auxiliary:r,update:d}),a.addHandler("wind",{element:"speed_range",auxiliary:r,update:d}),a.addHandler("wind",{element:"gust_range",auxiliary:r,update:d}),a.addHandler("cavok",{element:"cavok",auxiliary(e,t){const{result:a}=this,{visibility:n,visibility_range:s}=this.elements,{weather:l,intensity:i,precipitation:d,phenomena:r}=this.elements,{clouds_1_coverage:u,clouds_1:o,clouds_1_type:c,clouds_1_height:h}=this.elements,{clouds_2_coverage:m,clouds_2:p,clouds_2_type:_,clouds_2_height:U}=this.elements,{clouds_3_coverage:f,clouds_3:v,clouds_3_type:y,clouds_3_height:g}=this.elements,{clouds_4_coverage:b,clouds_4:H,clouds_4_type:k,clouds_4_height:E}=this.elements;t.checked?(n.value="",s.value=-1,l.value="",i.forEach((e=>e.checked=!1)),d.value="",r.value="",u.value="NCD",o.value="",c.forEach((e=>e.checked=!1)),h.value=-1,m.value="NCD",p.value="",_.forEach((e=>e.checked=!1)),U.value=-1,f.value="NCD",v.value="",y.forEach((e=>e.checked=!1)),g.value=-1,b.value="NCD",H.value="",k.forEach((e=>e.checked=!1)),E.value=-1,n.disabled=!0,s.disabled=!0,l.disabled=!0,i.forEach((e=>e.disabled=!0)),d.disabled=!0,r.disabled=!0,u.disabled=!0,o.disabled=!0,c.forEach((e=>e.disabled=!0)),h.disabled=!0,m.disabled=!0,p.disabled=!0,_.forEach((e=>e.disabled=!0)),U.disabled=!0,f.disabled=!0,v.disabled=!0,y.forEach((e=>e.disabled=!0)),g.disabled=!0,b.disabled=!0,H.disabled=!0,k.forEach((e=>e.disabled=!0)),E.disabled=!0,a.set("visibility",""),a.set("weather",""),a.set("clouds_1",""),a.set("clouds_2",""),a.set("clouds_3",""),a.set("clouds_4","")):(n.disabled=!1,s.disabled=!1,l.disabled=!1,i.forEach((e=>e.disabled=!1)),d.disabled=!1,r.disabled=!1,u.disabled=!1,o.disabled=!1,c.forEach((e=>e.disabled=!1)),h.disabled=!1,m.disabled=!1,p.disabled=!1,_.forEach((e=>e.disabled=!1)),U.disabled=!1,f.disabled=!1,v.disabled=!1,y.forEach((e=>e.disabled=!1)),g.disabled=!1,b.disabled=!1,H.disabled=!1,k.forEach((e=>e.disabled=!1)),E.disabled=!1)},update:(e,t)=>t.checked?t.value:""}),a.addHandler("visibility",{format:e=>e.trim().replace(/\D/,"").substring(0,4),auxiliary(e){const{visibility_range:a}=this.elements;""===e&&(a.value=-1);const n=+e,s=n<800?50:n<5e3?100:n<9999?1e3:0;let l=t.at(-1);if(s>0){const e=Math.floor(n/s)*s;l=t.indexOf(e)}a.value=l.toString()},update:u}),a.addHandler("visibility",{element:"visibility_range",init(e){const a=e[0];a.setAttribute("min",0),a.setAttribute("max",t.length-1),a.value=t[0]},auxiliary(e){e=+e;const{visibility:a}=this.elements;a.value=0===e?"":t[e]},update:u}),a.addHandler("weather",{element:"weather",format:e=>e.toUpperCase().replace(/[^-+A-Z ]/,""),auxiliary(e){const{intensity:t}=this.elements,a=e[0];for(const e of t)e.checked=e.value===a},update:c}),a.addHandler("weather",{element:"intensity",auxiliary(e,t){let a="";const{intensity:n,weather:s}=this.elements;for(const e of n)e!==t&&(e.checked=!1),e.checked&&(a=e.value);s.value=s.value.replace(/^[+-]/,""),a&&(s.value=a+s.value)},update:c}),a.addHandler("weather",{element:"precipitation",auxiliary:o,update:c}),a.addHandler("weather",{element:"phenomena",auxiliary:o,update:c}),a.addHandler("clouds_1",{element:"clouds_1",format:h,auxiliary:function(e){const{clouds_1_height:t}=this.elements;t.value=""===e?-1:+e},update:m}),a.addHandler("clouds_1",{element:"clouds_1_height",auxiliary:function(e){const{clouds_1:t}=this.elements;t.value=-1===+e?"":e},update:m}),a.addHandler("clouds_1",{element:"clouds_1_coverage",auxiliary:function(e){const{clouds_1:t,clouds_1_height:a,clouds_1_type:n}=this.elements;"NCD"===e&&(t.value="",a.value=-1,n.forEach((e=>e.checked=!1)))},update:m}),a.addHandler("clouds_1",{element:"clouds_1_type",auxiliary:function(e,t){const{clouds_1_type:a}=this.elements;for(const e of a)e!==t&&(e.checked=!1)},update:m}),a.addHandler("clouds_2",{element:"clouds_2",format:h,auxiliary:function(e){const{clouds_2_height:t}=this.elements;t.value=""===e?-1:+e},update:m}),a.addHandler("clouds_2",{element:"clouds_2_height",auxiliary:function(e){const{clouds_2:t}=this.elements;t.value=-1===+e?"":e},update:m}),a.addHandler("clouds_2",{element:"clouds_2_coverage",auxiliary:function(e){const{clouds_2:t,clouds_2_height:a,clouds_2_type:n}=this.elements;"NCD"===e&&(t.value="",a.value=-1,n.forEach((e=>e.checked=!1)))},update:m}),a.addHandler("clouds_2",{element:"clouds_2_type",auxiliary:function(e,t){const{clouds_2_type:a}=this.elements;for(const e of a)e!==t&&(e.checked=!1)},update:m}),a.addHandler("clouds_3",{element:"clouds_3",format:h,auxiliary:function(e){const{clouds_3_height:t}=this.elements;t.value=""===e?-1:+e},update:m}),a.addHandler("clouds_3",{element:"clouds_3_height",auxiliary:function(e){const{clouds_3:t}=this.elements;t.value=-1===+e?"":e},update:m}),a.addHandler("clouds_3",{element:"clouds_3_coverage",auxiliary:function(e){const{clouds_3:t,clouds_3_height:a,clouds_3_type:n}=this.elements;"NCD"===e&&(t.value="",a.value=-1,n.forEach((e=>e.checked=!1)))},update:m}),a.addHandler("clouds_3",{element:"clouds_3_type",auxiliary:function(e,t){const{clouds_3_type:a}=this.elements;for(const e of a)e!==t&&(e.checked=!1)},update:m}),a.addHandler("clouds_4",{element:"clouds_4",format:h,auxiliary:function(e){const{clouds_4_height:t}=this.elements;t.value=""===e?-1:+e},update:m}),a.addHandler("clouds_4",{element:"clouds_4_height",auxiliary:function(e){const{clouds_4:t}=this.elements;t.value=-1===+e?"":e},update:m}),a.addHandler("clouds_4",{element:"clouds_4_coverage",auxiliary:function(e){const{clouds_4:t,clouds_4_height:a,clouds_4_type:n}=this.elements;"NCD"===e&&(t.value="",a.value=-1,n.forEach((e=>e.checked=!1)))},update:m}),a.addHandler("clouds_4",{element:"clouds_4_type",auxiliary:function(e,t){const{clouds_4_type:a}=this.elements;for(const e of a)e!==t&&(e.checked=!1)},update:m}),a.addHandler("temperature",{element:"temperature",format:p,auxiliary:U,update:_}),a.addHandler("temperature",{element:"dew_point",format:p,auxiliary:U,update:_}),a.addHandler("temperature",{element:"temperature_range",auxiliary:f,update:_}),a.addHandler("temperature",{element:"dew_point_range",auxiliary:f,update:_}),a.addHandler("temperature",{element:"temperature_minus",auxiliary:v,update:_}),a.addHandler("temperature",{element:"dew_point_minus",auxiliary:v,update:_}),a.addHandler("pressure",{format:e=>""===(e=e.trim().replace(/\D/,"").substring(0,4))?"":+e>1100?1100:e,auxiliary(e){const{pressure_range:t}=this.elements;t.value=""===e||+e<500?499:e},update:y}),a.addHandler("pressure",{element:"pressure_range",auxiliary(e){const{pressure:t}=this.elements;t.value=499===+e?"":e},update:y}),a.addHandler("trend",{element:"trend_text",format:e=>e.trim().toUpperCase(),update:e=>e})})()}();